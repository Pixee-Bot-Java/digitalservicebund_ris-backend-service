<script setup lang="ts">
import { computed } from "vue"
import FlexContainer from "@/components/FlexContainer.vue"
import PreviewCategory from "@/components/preview/PreviewCategory.vue"
import PreviewContent from "@/components/preview/PreviewContent.vue"
import { ContentRelatedIndexing } from "@/domain/documentUnit"

const props = defineProps<{
  contentRelatedIndexing: ContentRelatedIndexing
}>()

const hasKeywords = computed(() => {
  return (
    props.contentRelatedIndexing.keywords &&
    props.contentRelatedIndexing.keywords?.length > 0
  )
})

const hasFieldsOfLaw = computed(() => {
  return (
    props.contentRelatedIndexing.fieldsOfLaw &&
    props.contentRelatedIndexing.fieldsOfLaw?.length > 0
  )
})

const hasNorms = computed(() => {
  return (
    props.contentRelatedIndexing.norms &&
    props.contentRelatedIndexing.norms?.length > 0
  )
})

const hasActiveCitations = computed(() => {
  return (
    props.contentRelatedIndexing.activeCitations &&
    props.contentRelatedIndexing.activeCitations?.length > 0
  )
})
</script>

<template>
  <FlexContainer class="flex-col">
    <FlexContainer v-if="hasKeywords" class="flex-row">
      <PreviewCategory>Schlagw√∂rter</PreviewCategory>
      <PreviewContent>
        <div
          v-for="(keyword, index) in contentRelatedIndexing.keywords"
          :key="index"
        >
          {{ keyword }}
        </div>
      </PreviewContent>
    </FlexContainer>
    <FlexContainer v-if="hasFieldsOfLaw" class="flex-row">
      <PreviewCategory>Sachgebiete</PreviewCategory>
      <PreviewContent>
        <div
          v-for="(fieldOfLaw, index) in contentRelatedIndexing.fieldsOfLaw"
          :key="index"
        >
          {{ fieldOfLaw.identifier }}, {{ fieldOfLaw.text }}
        </div>
      </PreviewContent>
    </FlexContainer>

    <FlexContainer v-if="hasNorms" class="flex-row">
      <PreviewCategory>Normen</PreviewCategory>
      <PreviewContent>
        <div v-for="(norm, index) in contentRelatedIndexing.norms" :key="index">
          <div v-if="norm.singleNorms && norm.singleNorms.length > 0">
            <div v-for="(singleNorm, i) in norm.singleNorms" :key="i">
              {{ norm.renderDecision }} - {{ singleNorm.renderDecision }}
            </div>
          </div>
          <div v-else>
            {{ norm.renderDecision }}
          </div>
        </div>
      </PreviewContent>
    </FlexContainer>

    <FlexContainer v-if="hasActiveCitations" class="flex-row">
      <PreviewCategory>Aktivzitierung</PreviewCategory>
      <PreviewContent>
        <div
          v-for="(
            activeCitation, index
          ) in contentRelatedIndexing.activeCitations"
          :key="index"
        >
          {{ activeCitation.renderDecision }}
        </div>
      </PreviewContent>
    </FlexContainer>
  </FlexContainer>
</template>
